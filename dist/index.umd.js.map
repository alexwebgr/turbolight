{
  "version": 3,
  "sources": ["../src/index.js"],
  "sourcesContent": ["/**\n * TurboLight - A lightweight, vanilla JavaScript lightbox that works with Turbo Streams\n *\n * Features:\n * - Gallery support with navigation\n * - Keyboard navigation\n * - Caption support\n * - Counter display\n * - Multiple closing options\n * - Turbo compatibility\n */\nclass TurboLight {\n  constructor(options = {}) {\n    // Default options\n    this.options = Object.assign({\n      imageClass: 'turbo-light-image',\n      captionClass: 'turbo-light-caption',\n      counterClass: 'turbo-light-counter',\n      closeClass: 'turbo-light-close',\n      prevClass: 'turbo-light-prev',\n      nextClass: 'turbo-light-next',\n      activeClass: 'turbo-light-active',\n      loadingClass: 'turbo-light-loading'\n    }, options);\n\n    // Initialize properties\n    this.galleries = {};\n    this.currentGallery = null;\n    this.currentIndex = 0;\n    this.isOpen = false;\n\n    // Bind methods to maintain 'this' context\n    this.handleClick = this.handleClick.bind(this);\n    this.close = this.close.bind(this);\n    this.next = this.next.bind(this);\n    this.previous = this.previous.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.handleBackgroundClick = this.handleBackgroundClick.bind(this);\n\n    // Store bound versions for event listener management\n    this.boundClose = this.close;\n    this.boundPrevious = this.previous;\n    this.boundNext = this.next;\n    this.boundHandleBackgroundClick = this.handleBackgroundClick;\n\n    // Initialize\n    this.init();\n  }\n\n  /**\n   * Initialize the lightbox\n   */\n  init() {\n    // Find all lightbox links and group them by gallery\n    this.findLinks();\n\n    // Remove any existing lightbox elements to prevent duplicates\n    this.cleanupExistingElements();\n\n    // Create new lightbox elements\n    this.createLightboxElements();\n  }\n\n  /**\n   * Clean up any existing lightbox elements in the DOM\n   */\n  cleanupExistingElements() {\n    const existingOverlay = document.querySelector('.turbo-light-overlay');\n    if (existingOverlay) {\n      // Remove event listeners to prevent memory leaks\n      const closeButton = existingOverlay.querySelector('.turbo-light-close');\n      const prevButton = existingOverlay.querySelector('.turbo-light-prev');\n      const nextButton = existingOverlay.querySelector('.turbo-light-next');\n\n      // Use bound event handlers if they exist, otherwise use direct methods\n      if (closeButton) closeButton.removeEventListener('click', this.boundClose);\n      if (prevButton) prevButton.removeEventListener('click', this.boundPrevious);\n      if (nextButton) nextButton.removeEventListener('click', this.boundNext);\n      existingOverlay.removeEventListener('click', this.boundHandleBackgroundClick);\n\n      // Remove the element from the DOM\n      existingOverlay.remove();\n    }\n  }\n\n  /**\n   * Find all links with data-turbolight attribute and group them by gallery\n   */\n  findLinks() {\n    // Reset galleries\n    this.galleries = {};\n\n    // Find all links with data-turbolight attribute\n    const links = document.querySelectorAll('a[data-turbolight]');\n\n    // Group links by gallery\n    links.forEach(link => {\n      const galleryName = link.dataset.turbolight;\n      const title = link.dataset.title || '';\n      const href = link.getAttribute('href');\n\n      if (!this.galleries[galleryName]) {\n        this.galleries[galleryName] = [];\n      }\n\n      this.galleries[galleryName].push({\n        href,\n        title,\n        element: link\n      });\n\n      // Add click event listener\n      link.removeEventListener('click', this.handleClick);\n      link.addEventListener('click', this.handleClick);\n    });\n  }\n\n  /**\n   * Create the lightbox DOM elements\n   */\n  createLightboxElements() {\n    // Create overlay\n    this.overlay = document.createElement('div');\n    this.overlay.className = 'turbo-light-overlay';\n\n    // Create container for the image\n    this.container = document.createElement('div');\n    this.container.className = 'turbo-light-container';\n\n    // Create image element\n    this.image = document.createElement('img');\n    this.image.className = 'turbo-light-image';\n\n    // Create caption\n    this.caption = document.createElement('div');\n    this.caption.className = 'turbo-light-caption';\n\n    // Create counter\n    this.counter = document.createElement('div');\n    this.counter.className = 'turbo-light-counter';\n\n    // Create close button\n    this.closeButton = document.createElement('button');\n    this.closeButton.className = 'turbo-light-close';\n    this.closeButton.innerHTML = '&times;';\n    this.closeButton.setAttribute('aria-label', 'Close lightbox');\n\n    // Create navigation buttons\n    this.prevButton = document.createElement('button');\n    this.prevButton.className = 'turbo-light-prev';\n    this.prevButton.innerHTML = '&#10094;';\n    this.prevButton.setAttribute('aria-label', 'Previous image');\n\n    this.nextButton = document.createElement('button');\n    this.nextButton.className = 'turbo-light-next';\n    this.nextButton.innerHTML = '&#10095;';\n    this.nextButton.setAttribute('aria-label', 'Next image');\n\n    // Assemble the elements\n    this.container.appendChild(this.image);\n    this.container.appendChild(this.caption);\n    this.overlay.appendChild(this.container);\n    this.overlay.appendChild(this.counter);\n    this.overlay.appendChild(this.closeButton);\n    this.overlay.appendChild(this.prevButton);\n    this.overlay.appendChild(this.nextButton);\n\n    // Add event listeners with properly bound context\n    this.closeButton.addEventListener('click', this.boundClose);\n    this.prevButton.addEventListener('click', this.boundPrevious);\n    this.nextButton.addEventListener('click', this.boundNext);\n    this.overlay.addEventListener('click', this.boundHandleBackgroundClick);\n\n    // Add to document\n    document.body.appendChild(this.overlay);\n  }\n\n  /**\n   * Handle click on lightbox link\n   * @param {Event} event - Click event\n   */\n  handleClick(event) {\n    event.preventDefault();\n\n    const link = event.currentTarget;\n    const galleryName = link.dataset.turbolight;\n\n    // Find the index of the clicked link in the gallery\n    const gallery = this.galleries[galleryName];\n    const index = gallery.findIndex(item => item.element === link);\n\n    this.open(galleryName, index);\n  }\n\n  /**\n   * Open the lightbox\n   * @param {string} galleryName - Gallery name\n   * @param {number} index - Index of the image to show\n   */\n  open(galleryName, index = 0) {\n    if (!this.galleries[galleryName]) {\n      console.error(`Gallery \"${galleryName}\" not found`);\n      return;\n    }\n\n    // Set current gallery and index\n    this.currentGallery = galleryName;\n    this.currentIndex = index;\n\n    // Show the lightbox\n    this.overlay.classList.add('turbo-light-active');\n    this.isOpen = true;\n\n    // Add keyboard event listener\n    document.addEventListener('keydown', this.handleKeyDown);\n\n    // Show the image\n    this.showImage(index);\n\n    // Prevent body scrolling\n    document.body.style.overflow = 'hidden';\n  }\n\n  /**\n   * Close the lightbox\n   */\n  close() {\n    if (!this.overlay) return;\n\n    // Hide the lightbox\n    this.overlay.classList.remove('turbo-light-active');\n    this.isOpen = false;\n\n    // Remove keyboard event listener\n    document.removeEventListener('keydown', this.handleKeyDown);\n\n    // Restore body scrolling\n    document.body.style.overflow = '';\n\n    // Reset current state\n    this.currentGallery = null;\n    this.currentIndex = 0;\n\n    // Clear content to prevent memory leaks and stale content\n    if (this.image) {\n      this.image.src = '';\n    }\n    \n    if (this.caption) {\n      this.caption.innerHTML = '';\n    }\n    \n    if (this.counter) {\n      this.counter.innerHTML = '';\n    }\n  }\n\n  /**\n   * Show the next image\n   */\n  next() {\n    if (!this.currentGallery) return;\n\n    const gallery = this.galleries[this.currentGallery];\n    let nextIndex = this.currentIndex + 1;\n\n    // Loop back to the beginning if at the end\n    if (nextIndex >= gallery.length) {\n      nextIndex = 0;\n    }\n\n    this.showImage(nextIndex);\n  }\n\n  /**\n   * Show the previous image\n   */\n  previous() {\n    if (!this.currentGallery) return;\n\n    const gallery = this.galleries[this.currentGallery];\n    let prevIndex = this.currentIndex - 1;\n\n    // Loop to the end if at the beginning\n    if (prevIndex < 0) {\n      prevIndex = gallery.length - 1;\n    }\n\n    this.showImage(prevIndex);\n  }\n\n  /**\n   * Show an image by index\n   * @param {number} index - Index of the image to show\n   */\n  showImage(index) {\n    if (!this.currentGallery) return;\n\n    const gallery = this.galleries[this.currentGallery];\n    if (index < 0 || index >= gallery.length) {\n      console.error(`Invalid index: ${index}`);\n      return;\n    }\n\n    // Update current index\n    this.currentIndex = index;\n\n    // Get the image data\n    const imageData = gallery[index];\n\n    // Show loading state\n    this.container.classList.add('turbo-light-loading');\n\n    // Update the image\n    this.image.src = imageData.href;\n    this.image.onload = () => {\n      this.container.classList.remove('turbo-light-loading');\n    };\n\n    // Update the caption\n    this.caption.innerHTML = imageData.title || '';\n\n    // Update the counter\n    this.updateCounter();\n  }\n\n  /**\n   * Update the counter display\n   */\n  updateCounter() {\n    if (!this.currentGallery) return;\n\n    const gallery = this.galleries[this.currentGallery];\n    this.counter.textContent = `${this.currentIndex + 1} / ${gallery.length}`;\n  }\n\n  /**\n   * Handle keyboard events\n   * @param {KeyboardEvent} event\n   */\n  handleKeyDown(event) {\n    if (!this.isOpen) return;\n\n    switch (event.key) {\n      case 'Escape':\n        this.close();\n        break;\n      case 'ArrowLeft':\n        this.previous();\n        break;\n      case 'ArrowRight':\n        this.next();\n        break;\n    }\n  }\n\n  /**\n   * Handle click on the background\n   * @param {MouseEvent} event\n   */\n  handleBackgroundClick(event) {\n    // Close only if clicking directly on the overlay, not its children\n    if (event.target === this.overlay) {\n      this.close();\n    }\n  }\n}\n\n// Export for module usage\nexport default TurboLight;\n"],
  "mappings": "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",
  "names": []
}
