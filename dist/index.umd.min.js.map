{
  "version": 3,
  "sources": ["../src/index.js"],
  "sourcesContent": ["/**\n * TurboLight - A lightweight, vanilla JavaScript lightbox that works with Turbo Streams\n *\n * Features:\n * - Gallery support with navigation\n * - Keyboard navigation\n * - Caption support\n * - Counter display\n * - Multiple closing options\n * - Turbo compatibility\n */\nclass TurboLight {\n  constructor(options = {}) {\n    // Default options\n    this.options = Object.assign({\n      imageClass: 'turbo-light-image',\n      captionClass: 'turbo-light-caption',\n      counterClass: 'turbo-light-counter',\n      closeClass: 'turbo-light-close',\n      prevClass: 'turbo-light-prev',\n      nextClass: 'turbo-light-next',\n      activeClass: 'turbo-light-active',\n      loadingClass: 'turbo-light-loading'\n    }, options);\n\n    // Initialize properties\n    this.galleries = {};\n    this.currentGallery = null;\n    this.currentIndex = 0;\n    this.isOpen = false;\n\n    // Bind methods to maintain 'this' context\n    this.handleClick = this.handleClick.bind(this);\n    this.close = this.close.bind(this);\n    this.next = this.next.bind(this);\n    this.previous = this.previous.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.handleBackgroundClick = this.handleBackgroundClick.bind(this);\n\n    // Store bound versions for event listener management\n    this.boundClose = this.close;\n    this.boundPrevious = this.previous;\n    this.boundNext = this.next;\n    this.boundHandleBackgroundClick = this.handleBackgroundClick;\n\n    // Initialize\n    this.init();\n  }\n\n  /**\n   * Initialize the lightbox\n   */\n  init() {\n    // Find all lightbox links and group them by gallery\n    this.findLinks();\n\n    // Remove any existing lightbox elements to prevent duplicates\n    this.cleanupExistingElements();\n\n    // Create new lightbox elements\n    this.createLightboxElements();\n  }\n\n  /**\n   * Clean up any existing lightbox elements in the DOM\n   */\n  cleanupExistingElements() {\n    const existingOverlay = document.querySelector('.turbo-light-overlay');\n    if (existingOverlay) {\n      // Remove event listeners to prevent memory leaks\n      const closeButton = existingOverlay.querySelector('.turbo-light-close');\n      const prevButton = existingOverlay.querySelector('.turbo-light-prev');\n      const nextButton = existingOverlay.querySelector('.turbo-light-next');\n\n      // Use bound event handlers if they exist, otherwise use direct methods\n      if (closeButton) closeButton.removeEventListener('click', this.boundClose);\n      if (prevButton) prevButton.removeEventListener('click', this.boundPrevious);\n      if (nextButton) nextButton.removeEventListener('click', this.boundNext);\n      existingOverlay.removeEventListener('click', this.boundHandleBackgroundClick);\n\n      // Remove the element from the DOM\n      existingOverlay.remove();\n    }\n  }\n\n  /**\n   * Find all links with data-turbolight attribute and group them by gallery\n   */\n  findLinks() {\n    // Reset galleries\n    this.galleries = {};\n\n    // Find all links with data-turbolight attribute\n    const links = document.querySelectorAll('a[data-turbolight]');\n\n    // Group links by gallery\n    links.forEach(link => {\n      const galleryName = link.dataset.turbolight;\n      const title = link.dataset.title || '';\n      const href = link.getAttribute('href');\n\n      if (!this.galleries[galleryName]) {\n        this.galleries[galleryName] = [];\n      }\n\n      this.galleries[galleryName].push({\n        href,\n        title,\n        element: link\n      });\n\n      // Add click event listener\n      link.removeEventListener('click', this.handleClick);\n      link.addEventListener('click', this.handleClick);\n    });\n  }\n\n  /**\n   * Create the lightbox DOM elements\n   */\n  createLightboxElements() {\n    // Create overlay\n    this.overlay = document.createElement('div');\n    this.overlay.className = 'turbo-light-overlay';\n\n    // Create container for the image\n    this.container = document.createElement('div');\n    this.container.className = 'turbo-light-container';\n\n    // Create image element\n    this.image = document.createElement('img');\n    this.image.className = 'turbo-light-image';\n\n    // Create caption\n    this.caption = document.createElement('div');\n    this.caption.className = 'turbo-light-caption';\n\n    // Create counter\n    this.counter = document.createElement('div');\n    this.counter.className = 'turbo-light-counter';\n\n    // Create close button\n    this.closeButton = document.createElement('button');\n    this.closeButton.className = 'turbo-light-close';\n    this.closeButton.innerHTML = '&times;';\n    this.closeButton.setAttribute('aria-label', 'Close lightbox');\n\n    // Create navigation buttons\n    this.prevButton = document.createElement('button');\n    this.prevButton.className = 'turbo-light-prev';\n    this.prevButton.innerHTML = '&#10094;';\n    this.prevButton.setAttribute('aria-label', 'Previous image');\n\n    this.nextButton = document.createElement('button');\n    this.nextButton.className = 'turbo-light-next';\n    this.nextButton.innerHTML = '&#10095;';\n    this.nextButton.setAttribute('aria-label', 'Next image');\n\n    // Assemble the elements\n    this.container.appendChild(this.image);\n    this.container.appendChild(this.caption);\n    this.overlay.appendChild(this.container);\n    this.overlay.appendChild(this.counter);\n    this.overlay.appendChild(this.closeButton);\n    this.overlay.appendChild(this.prevButton);\n    this.overlay.appendChild(this.nextButton);\n\n    // Add event listeners with properly bound context\n    this.closeButton.addEventListener('click', this.boundClose);\n    this.prevButton.addEventListener('click', this.boundPrevious);\n    this.nextButton.addEventListener('click', this.boundNext);\n    this.overlay.addEventListener('click', this.boundHandleBackgroundClick);\n\n    // Add to document\n    document.body.appendChild(this.overlay);\n  }\n\n  /**\n   * Handle click on lightbox link\n   * @param {Event} event - Click event\n   */\n  handleClick(event) {\n    event.preventDefault();\n\n    const link = event.currentTarget;\n    const galleryName = link.dataset.turbolight;\n\n    // Find the index of the clicked link in the gallery\n    const gallery = this.galleries[galleryName];\n    const index = gallery.findIndex(item => item.element === link);\n\n    this.open(galleryName, index);\n  }\n\n  /**\n   * Open the lightbox\n   * @param {string} galleryName - Gallery name\n   * @param {number} index - Index of the image to show\n   */\n  open(galleryName, index = 0) {\n    if (!this.galleries[galleryName]) {\n      console.error(`Gallery \"${galleryName}\" not found`);\n      return;\n    }\n\n    // Set current gallery and index\n    this.currentGallery = galleryName;\n    this.currentIndex = index;\n\n    // Show the lightbox\n    this.overlay.classList.add('turbo-light-active');\n    this.isOpen = true;\n\n    // Add keyboard event listener\n    document.addEventListener('keydown', this.handleKeyDown);\n\n    // Show the image\n    this.showImage(index);\n\n    // Prevent body scrolling\n    document.body.style.overflow = 'hidden';\n  }\n\n  /**\n   * Close the lightbox\n   */\n  close() {\n    if (!this.overlay) return;\n\n    // Hide the lightbox\n    this.overlay.classList.remove('turbo-light-active');\n    this.isOpen = false;\n\n    // Remove keyboard event listener\n    document.removeEventListener('keydown', this.handleKeyDown);\n\n    // Restore body scrolling\n    document.body.style.overflow = '';\n\n    // Reset current state\n    this.currentGallery = null;\n    this.currentIndex = 0;\n\n    // Clear content to prevent memory leaks and stale content\n    if (this.image) {\n      this.image.src = '';\n    }\n    \n    if (this.caption) {\n      this.caption.innerHTML = '';\n    }\n    \n    if (this.counter) {\n      this.counter.innerHTML = '';\n    }\n  }\n\n  /**\n   * Show the next image\n   */\n  next() {\n    if (!this.currentGallery) return;\n\n    const gallery = this.galleries[this.currentGallery];\n    let nextIndex = this.currentIndex + 1;\n\n    // Loop back to the beginning if at the end\n    if (nextIndex >= gallery.length) {\n      nextIndex = 0;\n    }\n\n    this.showImage(nextIndex);\n  }\n\n  /**\n   * Show the previous image\n   */\n  previous() {\n    if (!this.currentGallery) return;\n\n    const gallery = this.galleries[this.currentGallery];\n    let prevIndex = this.currentIndex - 1;\n\n    // Loop to the end if at the beginning\n    if (prevIndex < 0) {\n      prevIndex = gallery.length - 1;\n    }\n\n    this.showImage(prevIndex);\n  }\n\n  /**\n   * Show an image by index\n   * @param {number} index - Index of the image to show\n   */\n  showImage(index) {\n    if (!this.currentGallery) return;\n\n    const gallery = this.galleries[this.currentGallery];\n    if (index < 0 || index >= gallery.length) {\n      console.error(`Invalid index: ${index}`);\n      return;\n    }\n\n    // Update current index\n    this.currentIndex = index;\n\n    // Get the image data\n    const imageData = gallery[index];\n\n    // Show loading state\n    this.container.classList.add('turbo-light-loading');\n\n    // Update the image\n    this.image.src = imageData.href;\n    this.image.onload = () => {\n      this.container.classList.remove('turbo-light-loading');\n    };\n\n    // Update the caption\n    this.caption.innerHTML = imageData.title || '';\n\n    // Update the counter\n    this.updateCounter();\n  }\n\n  /**\n   * Update the counter display\n   */\n  updateCounter() {\n    if (!this.currentGallery) return;\n\n    const gallery = this.galleries[this.currentGallery];\n    this.counter.textContent = `${this.currentIndex + 1} / ${gallery.length}`;\n  }\n\n  /**\n   * Handle keyboard events\n   * @param {KeyboardEvent} event\n   */\n  handleKeyDown(event) {\n    if (!this.isOpen) return;\n\n    switch (event.key) {\n      case 'Escape':\n        this.close();\n        break;\n      case 'ArrowLeft':\n        this.previous();\n        break;\n      case 'ArrowRight':\n        this.next();\n        break;\n    }\n  }\n\n  /**\n   * Handle click on the background\n   * @param {MouseEvent} event\n   */\n  handleBackgroundClick(event) {\n    // Close only if clicking directly on the overlay, not its children\n    if (event.target === this.overlay) {\n      this.close();\n    }\n  }\n}\n\n// Export for module usage\nexport default TurboLight;\n"],
  "mappings": "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",
  "names": ["src_exports", "__export", "src_default", "TurboLight", "options", "existingOverlay", "closeButton", "prevButton", "nextButton", "link", "galleryName", "title", "href", "event", "index", "item", "gallery", "nextIndex", "prevIndex", "imageData"]
}
